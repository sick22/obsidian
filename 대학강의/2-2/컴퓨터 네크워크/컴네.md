## 4 유선 및 무선 데이터 전송

### 통신선
전송 매체란 신호를 한쪽에서 다른 쪽으로 전달하는데 사용되는 물질
그 중 유선 전송 매체가 통신선이다. 
외부의 힘에 의해 통신선에 흐르는 신호는 간섭을 받음
통신선의 역할은 외부의 영향을 덜 받으면서도 최대한 멀리까지 신호를 전송하는 것.
**꼬임선 twisted pair**
- 두개의 선을 꼬아서 사용하는 선
- 이더넷에서 사용하는 선 (RJ-45)
- 10 ~ 100Mbps의 속도로 100 ~ 1km
**동축선 (coaxial cable)**
- 중앙에 구리선 피복 그물망 외부피복으로 감싸져있는 선
- 동축선의 연결단자를 BNC 단자라고 함
- 10Mbps ~ 1Gbps의 속도로 1~ 10km까지 데이터 전송
**광섬유 (fiber optics)** 
- 광섬유는 머리카락보다 가느다란 선에 빛을 이용하여 데이터를 전송하는 매체
- 선 하나가 수 기가의 데이터를 수백km까지 전송
- 빛을 이용하기에 도청이 어려움
- 모든 선이 매끈하게 이어져야함
- 생산단가 비쌈
- 매설, 연결 비용 비쌈

| 선   | 대역폭        | 전송거리       | 특징                |
| --- | ---------- | ---------- | ----------------- |
| 꼬임선 | 10~100Mbps | 100m ~ 1km | 외부 간섭에 약함, 도청 가능  |
| 동축선 | 10~1Gbps   | 1~10km     | 외부 간섭에 중간, 도청 가능  |
| 광섬유 | 2~200Gps   | 10~100km   | 외부 간섭에 강함, 도청 불가능 |

**전력선 통신 (PLC)**
- 통신선을 설치하기 어려운 곳
- 전력선에 고주파를 전송
- 변압기를 통과 할 때 /  변압기를 통과할 때 데이터의 손실
- 가전제품을 이용할 때 생기는 전압차로 인해 오류 발생
### 무선 전송의 특성
저음이 고음보다 투과성이 좋음 고음은 직진하며 반사되는 성질 하지만 정보량이 많음
무선통신은 다양한 주파수를 사용ㅇ함
낮은 주파수는 멀리가지만 정보의 양이 적음

| 구분  | 낮은 주파수 (AM)   | 높은 주파수 (FM) |
| --- | ------------- | ----------- |
| 방향성 | 퍼져 나간다        | 한 방향으로 직진   |
| 장애물 | 투과성이 좋아 뚫고 확산 | 장애물을 만나면 반사 |
| 정보량 | 정보량이 적다       | 정보량이 많다     |
라디오는 라디오 주파수 대역을 사용하는 통신 장비
마이크로웨이브 오븐은 마이크로웨이브 주파수를 사용하여 음식물을 가열하는 가전기기

음파영역은 가청주파수 20Hz ~2,0000Hz 무선통신 시스템은 없음
라디오는 가장 많은 통신기가 위치하는 대역으로 10KHz ~ 300MHz대역
REID 라디오 주파수를 사용하여 식별하는 장치 (Radio Frequency Idntification)
자동차의 스마트키도 라디오 영역 주파수를 사용하고, 무선 조정기로 움직이는 자동차나 로봇과 같은 장난감도 라디오 주파수를 사용

마이크로 영역은 300MHz ~ 30GHz
국가는 자유롭게 통신기기를 제작할 수 있는 여역을 만들어줌 대표적으로 2.4GHz and 5GHz
와이파이 위성통신이 있음

적외선을 사용하는 통신 장비 리모컨
유선 전송매체 광섬유는 적외선만 사용 주파수가 높아지면 섬유에 손상을 입힐 수 있음

### 다중접속
귀중한  전파를 다수의 사용자가 접속할 수 있게 하는 다중접속 (Multi access) 기술
주파수 분할 다중접속 (FDMA; Frequency Division Multiple Access)
시분할 다중접속(TDMA; Time Division Multiple Access)
코드분할 다중접속 (CDMA; Code Division Multiple Access)

코드분한 다중접속 (CDMA) 는 전세계에서 한국이 첫 상용화 종주국

**FDMA**
	사용 가능한 전체 대역폭을 잘게 쪼개어 사용자에게 나누어 주는 것
- 고속도로에 여러개의 차선을 만드는 것과 같음
- 주파수 분할 방식을 사용하는 대표적인 통신기기 : TV RADIO
- 1세대 무선통신망 (1G)이 FDMA이용함
- 한 사람이 하나의 채널을 할당 받기에 주고받는 데이터가 없어도 채널을 공유하지 못함. 대역폭의 낭비가 발생
**TDMA**
	하나의 채널을 여러 사람이 나누어 쓰는 방식 디지털 신호에만 적용이 가능
- 3명이 번갈아 가면서 짧은 시간 동안 데이터를 전송하는 방식
- 운영체제의 시분할 시스템과 같은 원리
- 유럽의 디지털 이용통신 서비스 방식인 GSM(Global System for mobile communications)
**CDMA**
칩에 구멍을 뚫어서 같은 공간에 같은 통신사를 사용하는 모두에게 같은 데이터를 전달함 각자의 할당된 칩의 데이터를 얻음 도청에 강함
칩의 구멍을 담당하는 코드를 칩 시퀀스라 부름
유심칩 안에 칩 시퀀스 저장
칩 시퀀스는 64개나 128개로 이뤄짐
1을 전송할 때는 0을 -1로 변경하여 전송
0을 전송할 때는 0을 1 ,1을 0으로 전송

A x A = 1
A x B = 0
A x Ā = -1
### 변조
	신호를 다른 종류의 신호로 변화시키는 것

아날로그-아날로그 변조에는 전송파, 반송파를 사용
진폭변조(Amplitude Modulation) 방식과 주파수 변조 방식(Frequency Modulation)이 있음
진폭 변조 방식을 AM 주파수 변조 방식을 FM이라고 부름

AM : 진폭 전송파에 원래 신호의 진폭을 결합 (거리)
FM : 원래 신호의 높낮이에 따라 주파수를 변화 (음질)

디지털-아날로그 변조
진폭편이 변조(ASK)
주파수편이 변조(FSK)
위상편이 변조(PSK)

대역폭이 일정할 경우, 신호로 구분할 수 있는 숫자를 늘려야만 전송률이 올라감 2H X logL 
직교진폭 변조 (Quadraturre Ampliitude Modulation)
	진폭 변조와 위상 변조를 사용하여 하나의 신호로 구분할 수 있는 숫자를 늘리는 방식
8QAM에서는 4개의 서로다른 위상을 가진 신호를 구분 가능

## 5 통신망과 특징
### 유선통신망

**회선 교환망 (circuit switching network)**
전화기가 발명된 초기에는 단추가 없었기에 회선 교환을 했음 (circuit switching)
이후 전자시 ㄱ교환기가 생가나 전화번호를 누르면 번호에 해당하는 선을 자동으로 연결
전화망에서는 통신이 시작되기 전에 통신합의 과정과 콜셋업이 필요. 독점 사용 및 시간당 과금 -> PSTM(공중 교환 전화망)
누른 번호에 따른 교환기 끼리의 길을 연결하는 것이 콜 셋업이다.

**패킷 교환망(packet switching network)**
IP주소를 보고 **라우터**가 패킷을 보낼 선을 결정하여 경로를 설정
통신합의나 콜셋업 없이 무조건 데이터를 전송하는 전보 방식
가장 빠르다고 생각하는 길로 패킷이 이동
순서가 섞이거나 패킷이 사라짐

패킷을 이용하는 이유는
서로 다른 LAN을 모아서 인터넷을 구성하므로 IP주소도 제각각이고 특성도 다름
ARPAnet에서 이런 특성을 고려하여 라우터가 고장 나더라도 목적지까지 데이터를 전송할 수 있도록 설계
패킷 교환은 망을 독점하지 않아서 효율성이 증가함

| 전화망                | 인터넷망              |
| ------------------ | ----------------- |
| 일관된 시스템에 의해 데이터 전송 | 라우터의 협업에 의해 패킷 전송 |
| 콜 셋업을 통해 회로 우선     | 패킷 우선으로 빠른 길을 택   |
| 베타적이고 독점적임         | 모든 선을 공유          |
| 안정                 | 효율                |
| 데이터가 순서대로 도착       | 데이터 순서 바뀌고 사라짐    |
외부에 노충되지 않는 네트워크를 사설망 반대를 공중망
이미 설치된 인터넷 망을 이용해 구축한 사설 네트워크를 VPN(Virtiual Private Network)
VPN은 회선교환과 패킷교환의 장점을 모두 가진 가상회선 방식

처음 만들어진 무선 통신 시스템으로는 무선 호출기(삐삐) 단방향 통신 시스템 숫자만 전송 가능
이동통신 서비스는 1984년 시작, 1997년 새로운 통신 서비스 씨티폰 (발신만 가능함) PCS 휴대폰 통신 품질은 떨어지지만 수신, 발신, 문자 서비스까지 가능한 휴대폰 요금도 저렴함

1G 이동통신 AM/FM 같은 아날로ㄷ그 방식으로 음성 전송
2G 아날로그를 디지털로 바꾼것, 코드분할 방식 CDM 
3G 무선 데이터 통신이 가능
4G(LTE) 고속 무선 데이터 통신 가능, 음성은 3G
5G 이동통신은 최대 20Gbps의 속도 
## 6 데이터 링크 계층의 작업

### 프레임
물리 계층을 이용하여 lan에 속해있는 노드들에게 데이터를 전송하는것
패킷에 데이터 링크 계층이 사용하는 헤더를 붙임
데이터 단위를 프레임이라고 부름
데이터 전송방식은 예고 없이 데이터를 보내는 비동기식 전송과 데이터를 전송한다고 알려준 후 프레임을 보내는 동기식 전송으로 나눌 수 있음. 현재는 동기식 전송 사용

동기식 전송에서는 데이터를 보내기 전에 통신시작을 알리는 신호가 플래그
프레임을 시작할 때와 마찬가지로 프레임이 언제 끝날지를 알려주어야 함
앞에 붙이는 플래그를 프리앰블 뒤에 붙이는 플래그를 포스트플래그

프레임 내에 플래그와 같은 패턴을 가진 데이터가 존재하는 경우 문제가 발생할 수 있음
플래그와 같은 패턴이 있을 경우, 그 앞에 이스케이프 문자를 삽입하여 전송
프레임 안에 ESC + 플래그 패턴이 들어있는 경우, ESC + 플래그 앞에 ESC를 하나 더 붙여서 보냄

**문자 프레임**
문자 프레임에서는 데이터를 아스키 코드 형태로 전송
문자 프레임에서 프리앰블은 DLE STX를 붙여서 사용하고 포스트 앰블로 DLE ETX를 사용
STX는 전송 텍스트의 시작을 나타내는 제어 문자이며, ETX는 전송 텍스트를 끝을 나타내는 제어문자
데이터에 DLE ETX가 나타나는 경우에는 DLE ETX 앞에 DLE를 하나 더 붙여서 전송 -> **문자 스터핑**
문자 프레임은 현재 거의 사용하지 않음
문자 프레임은 프레임 데이터를 문자로 해석, 플래그도 아스키 코드 제어 문자열

**비트 프레임**
프리 앰블과 포스트 앰블에 비트패턴을 사용 
데이터에 플래그와 같은 패턴이 나타나면 연달아 나타나는 1의 다섯 번째 다음에 0을 하나 삽입  -> **비트 스터핑**

#### 슬라이딩 윈도우 프로토콜

ACK이 없다면 두번째 프레임을 수신자가 첫번째 프레임으로 오해할 수 있음
ACK을 보냈는데 ACK이 사라진다면 새로운 프레임을 전송할 수 없음 수신자는 두 번째 프레임이 오지않아서 ACK을 보낼 수 없음 양쪽 모두 **타임아웃** 사용

송신자가 타임아웃이 걸려 같은 프레임을 2번 보낸 이후에 ACK이 도착
수신자는 ACK을 보낸 후 프레임을 받았기 때문에 두번째 프레임이라고 생각함

**일련번호 (sequence number)** 사용하면 몇 번째 프레임인지 정확히 알게 됨.

0번 프레임이 지연된 후 송신자가 타임아웃을 통해 다시 프레임을 전송하고 지연된 ACK이 도착했을 경우 정상적인 파일이 왔다 생각하고 1번 프레임을 전송하였지만 소멸되면 두 번쨰 0번 프레임을 받은 ACK이 도착하여 정상적인 데이터 전송이 이뤄진줄 알게 된다. 

**ACK 일련번호 사용**
송신자는 0번 ACK가 두 번 도착하여 중복되었다는 사실을 알고 폐기
문제 해결!

**데이터 전송 필수요소**
- 응답 메시지 (ACK) 
- 타임아웃 
- 프레임 일련번호
- ACK 일련번호

**피기백킹**
	양방향 통신이 이뤄지기에 전송되는 데이터에 ACK를 같이 넣어 보내면 네트워크 혼잡도를 줄일 수 있음


데이터를 보낸 후 멈추고 ACK을 기다리는 stop-and-wait 방식은 매우 느림
ACK 없이 한꺼번에 많은 양의 데이터를 보내면 전송속도가 올라감 -> **슬라이딩 윈도우 프로토콜**

**Stop-and-Wait** 방식을 ARQ라 부름 윈도우 사이즈 1
**Go-Back-N ARQ**는 NACK을 받으면 NACK 프레임부터 재전송
**Selective Repeat ARQ**는 NACK을 받은 2번만 보냄
버퍼가 필요하고 순서를 맞춰야함 -> 회로도 복잡
**Adaptive ARQ**에서는 네트워크 안정도에 따라 **프레임**의 크기를 늘림 (윈도우가 아닌 프레임이다)
회로가 복잡하기에 사용하지 않음


오류처리코드

| 방식       | 종류                  | 비고                 |
| -------- | ------------------- | ------------------ |
| 오류 탐색 코드 | 패리트 비트, CRC 코드, 검사합 | 오류를 찾음             |
| 오류 보정 코드 | 해밍 코드               | 오류를 찾고 보정, 오버헤드가 큼 |
가장 간단한 에러 탐색 코드가 **패리티 비트**
1비트를 추가하여 홀수 짝수로 만다는 것
1의 개수가 짝수이면 **짝수 패리티 비트** , 홀수이면 **홀수 패리티 비트**
연속에러에 취약해서 짝수개의 오류 발생시 에러 탐색 불가

패리티 비트를 수직과 수평에 배열할 수도 있지만 에러에 취약함
보통 한개의 패리티 비트에 한개의 오류 탐색 가능

CRC 코도는 적은 오버헤드로 많은 에러 탐색
CRC 코드 값을 통해 데이터를 나눠서 나머지가 0이 되도록 숫자를 추가하여 보냄
항상 탐색 에러의 개수는 CRC - 1

